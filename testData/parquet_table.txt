--Error:Java.lang.RuntimeException: java.lang.ClassNotFoundException:parquet.hive.DeprecatedParquetInputFormat
--Impala
CREATE TABLE mytest.t_dim_date_p
(
  date                   BIGINT      ,
  year                   int         ,
  month                  int         ,
  day                    int         ,
  week                   int         ,
  quarter                int
)
ROW FORMAT SERDE 'parquet.hive.serde.ParquetHiveSerDe' stored as
INPUTFORMAT 'parquet.hive.DeprecatedParquetInputFormat'
OUTPUTFORMAT 'parquet.hive.DeprecatedParquetOutputFormat';

--spark-sql
CREATE TABLE lsj_test.t_dim_date_p
(
  date                   BIGINT      ,
  year                   int         ,
  month                  int         ,
  day                    int         ,
  week                   int         ,
  quarter                int
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' stored as
INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'